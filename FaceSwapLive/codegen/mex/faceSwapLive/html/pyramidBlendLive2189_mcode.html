<pre class="code">
<span class="srcline"><span class="lineno"><a href="230,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S2T127U3">imageRecon</span> ] = pyramidBlendLive(<span class="var type1" id="S3T802U6">im1</span>, <span class="var type1" id="S4T127U7">im2</span>, <span class="var type1" id="S5T804U8">mask</span>, <span class="mxinfo " id="T4:U5"><span class="var type2" id="S6T4V1U9">levels</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="230,2" id="srcline2">  2</a></span><span class="line"><span class="comment">%PYRAMIDBLUR pyramid blur two pyramid objects using a binary mask</span></span></span>
<span class="srcline"><span class="lineno"><a href="230,3" id="srcline3">  3</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="230,4" id="srcline4">  4</a></span><span class="line"><span class="mxinfo " id="T805:U7"><span class="var type1" id="S7T805U12">gaussian1</span> = <span class="mxinfo " id="T805:U9">zeros([size(<span class="var type1" id="S3T802U19">im1</span>) <span class="var type1" id="S6T4U20">levels</span>], <span class="string">'like'</span>, <span class="var type1" id="S3T802U22">im1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="230,5" id="srcline5">  5</a></span><span class="line"><span class="mxinfo " id="T805:U13"><span class="var type1" id="S10T805U25">gaussian2</span> = <span class="mxinfo " id="T805:U15">zeros([size(<span class="var type1" id="S4T127U32">im2</span>) <span class="var type1" id="S6T4U33">levels</span>], <span class="string">'like'</span>, <span class="var type1" id="S3T802U35">im1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="230,6" id="srcline6">  6</a></span><span class="line"><span class="mxinfo " id="T929:U19"><span class="var type1" id="S11T929U38">laplacian1</span> = <span class="mxinfo " id="T929:U21">zeros([size(<span class="var type1" id="S3T802U45">im1</span>) <span class="var type1" id="S6T4U47">levels</span>-1], <span class="string">'like'</span>, <span class="var type1" id="S3T802U50">im1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="230,7" id="srcline7">  7</a></span><span class="line"><span class="mxinfo " id="T929:U25"><span class="var type1" id="S12T929U53">laplacian2</span> = <span class="mxinfo " id="T929:U27">zeros([size(<span class="var type1" id="S3T802U60">im1</span>) <span class="var type1" id="S6T4U62">levels</span>-1], <span class="string">'like'</span>, <span class="var type1" id="S3T802U65">im1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="230,8" id="srcline8">  8</a></span><span class="line"><span class="mxinfo " id="T806:U31"><span class="var type1" id="S13T806U68">imsize</span> = <span class="mxinfo " id="T806:U33">zeros(<span class="mxinfo " id="T4:U34"><span class="var type1" id="S6T4U71">levels</span></span>, <span class="mxinfo " id="T4:U36">2</span>, <span class="string">'like'</span>, <span class="var type1" id="S3T802U74">im1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="230,9" id="srcline9">  9</a></span><span class="line"><span class="mxinfo " id="T899:U38"><span class="var type1" id="S14T899U77">gaussMask</span> = <span class="mxinfo " id="T899:U40">false([size(<span class="var type1" id="S5T804U84">mask</span>) <span class="var type1" id="S6T4U85">levels</span>])</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="230,10" id="srcline10"> 10</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="230,11" id="srcline11"> 11</a></span><span class="line"><span class="mxinfo " id="T802:U43"><span class="mxinfo " id="T802:U44"><span class="var type1" id="S7T805U89">gaussian1</span>(:,:,:,<span class="mxinfo " id="T4:U46">1</span>)</span> = <span class="var type1" id="S3T802U94">im1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="230,12" id="srcline12"> 12</a></span><span class="line"><span class="mxinfo " id="T173:U48"><span class="mxinfo " id="T173:U49"><span class="var type1" id="S13T806U98">imsize</span>(<span class="mxinfo " id="T4:U51">1</span>,:)</span> = <span class="mxinfo " id="T173:U52">size(<span class="var type1" id="S3T802U104">im1</span>(:,:,1))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="230,13" id="srcline13"> 13</a></span><span class="line"><span class="mxinfo " id="T802:U54"><span class="mxinfo " id="T802:U55"><span class="var type1" id="S10T805U111">gaussian2</span>(:,:,:,<span class="mxinfo " id="T4:U57">1</span>)</span> = <span class="var type1" id="S4T127U116">im2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="230,14" id="srcline14"> 14</a></span><span class="line"><span class="mxinfo " id="T804:U59"><span class="mxinfo " id="T804:U60"><span class="var type1" id="S14T899U120">gaussMask</span>(:,:,<span class="mxinfo " id="T4:U62">1</span>)</span> = <span class="var type1" id="S5T804U124">mask</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="230,15" id="srcline15"> 15</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="230,16" id="srcline16"> 16</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S16T4U127">i</span> = <span class="mxinfo " id="T4:U65">2</span>:<span class="var type1" id="S6T4U130">levels</span></span></span>
<span class="srcline"><span class="lineno"><a href="230,17" id="srcline17"> 17</a></span><span class="line">    [<span class="mxinfo " id="T802:U67"><span class="var type1" id="S7T805U135">gaussian1</span>(:,:,:,<span class="var type1" id="S16T4U139">i</span>)</span>, <span class="mxinfo " id="T802:U70"><span class="var type1" id="S11T929U141">laplacian1</span>(:,:,:,<span class="mxinfo " id="T4:U72"><span class="var type1" id="S16T4U146">i</span>-<span class="mxinfo " id="T4:U74">1</span></span>)</span>, <span class="mxinfo " id="T173:U75"><span class="var type1" id="S13T806U149">imsize</span>(<span class="var type1" id="S16T4U150">i</span>,:)</span>] = <span class="fcn" id="F2119N24:B153">pyrBlendDown</span>(<span class="mxinfo " id="T802:U78"><span class="var type1" id="S7T805U155">gaussian1</span>(:,:,:,<span class="mxinfo " id="T4:U80"><span class="var type1" id="S16T4U160">i</span>-<span class="mxinfo " id="T4:U82">1</span></span>)</span>, <span class="mxinfo " id="T173:U83"><span class="var type1" id="S13T806U163">imsize</span>(<span class="mxinfo " id="T4:U85"><span class="var type1" id="S16T4U165">i</span>-<span class="mxinfo " id="T4:U87">1</span></span>,:)</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="230,18" id="srcline18"> 18</a></span><span class="line">    [<span class="mxinfo " id="T802:U88"><span class="var type1" id="S10T805U172">gaussian2</span>(:,:,:,<span class="var type1" id="S16T4U176">i</span>)</span>, <span class="mxinfo " id="T802:U91"><span class="var type1" id="S12T929U178">laplacian2</span>(:,:,:,<span class="mxinfo " id="T4:U93"><span class="var type1" id="S16T4U183">i</span>-<span class="mxinfo " id="T4:U95">1</span></span>)</span>, <span class="mxinfo " id="T4:U96"><span class="mxinfo " id="T4:U97">~</span></span>           ] = <span class="fcn" id="F2119N24:B187">pyrBlendDown</span>(<span class="mxinfo " id="T802:U98"><span class="var type1" id="S10T805U189">gaussian2</span>(:,:,:,<span class="mxinfo " id="T4:U100"><span class="var type1" id="S16T4U194">i</span>-<span class="mxinfo " id="T4:U102">1</span></span>)</span>, <span class="mxinfo " id="T173:U103"><span class="var type1" id="S13T806U197">imsize</span>(<span class="mxinfo " id="T4:U105"><span class="var type1" id="S16T4U199">i</span>-<span class="mxinfo " id="T4:U107">1</span></span>,:)</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="230,19" id="srcline19"> 19</a></span><span class="line">    [<span class="mxinfo " id="T804:U108"><span class="var type1" id="S14T899U206">gaussMask</span>(:,:,<span class="var type1" id="S16T4U209">i</span>)</span>,   <span class="mxinfo " id="T4:U111"><span class="mxinfo " id="T4:U112">~</span></span>,                     <span class="mxinfo " id="T4:U113"><span class="mxinfo " id="T4:U114">~</span></span>           ] = <span class="fcn" id="F2158N24:B213">pyrBlendDown</span>(<span class="mxinfo " id="T804:U115"><span class="var type1" id="S14T899U215">gaussMask</span>(:,:,<span class="mxinfo " id="T4:U117"><span class="var type1" id="S16T4U219">i</span>-<span class="mxinfo " id="T4:U119">1</span></span>)</span>, <span class="mxinfo " id="T173:U120"><span class="var type1" id="S13T806U222">imsize</span>(<span class="mxinfo " id="T4:U122"><span class="var type1" id="S16T4U224">i</span>-<span class="mxinfo " id="T4:U124">1</span></span>,:)</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="230,20" id="srcline20"> 20</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T1:U125"><span class="mxinfo " id="T4:U126">sum(<span class="mxinfo " id="T173:U127"><span class="var type1" id="S13T806U233">imsize</span>(<span class="var type1" id="S16T4U234">i</span>,:)</span>)</span> &lt; <span class="mxinfo " id="T4:U130">12</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="230,21" id="srcline21"> 21</a></span><span class="line">        <span class="mxinfo " id="T4:U131"><span class="var type1" id="S6T4U239">levels</span> = <span class="var type1" id="S16T4U240">i</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="230,22" id="srcline22"> 22</a></span><span class="line">        <span class="keyword">break</span></span></span>
<span class="srcline"><span class="lineno"><a href="230,23" id="srcline23"> 23</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="230,24" id="srcline24"> 24</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="230,25" id="srcline25"> 25</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="230,26" id="srcline26"> 26</a></span><span class="line"><span class="mxinfo " id="T802:U134"><span class="var type1" id="S2T802U244">imageRecon</span> = <span class="mxinfo " id="T802:U136"><span class="mxinfo " id="T802:U137">bsxfun(@times, <span class="mxinfo " id="T802:U138"><span class="var type1" id="S7T805U251">gaussian1</span>(:,:,:,<span class="var type1" id="S6T4U255">levels</span>)</span>, <span class="mxinfo " id="T804:U141"><span class="var type1" id="S14T899U257">gaussMask</span>(:,:,<span class="var type1" id="S6T4U260">levels</span>)</span>)</span> + <span class="mxinfo " id="T802:U144">bsxfun(@times, <span class="mxinfo " id="T802:U145"><span class="var type1" id="S10T805U266">gaussian2</span>(:,:,:,<span class="var type1" id="S6T4U270">levels</span>)</span>, <span class="mxinfo " id="T804:U148">~<span class="mxinfo " id="T804:U149"><span class="var type1" id="S14T899U273">gaussMask</span>(:,:,<span class="var type1" id="S6T4U276">levels</span>)</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="230,27" id="srcline27"> 27</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="230,28" id="srcline28"> 28</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S16T4U279">i</span> = (<span class="mxinfo " id="T4:U153"><span class="var type1" id="S6T4U284">levels</span>-<span class="mxinfo " id="T4:U155">1</span></span>):<span class="mxinfo " id="T4:U156">-1</span>:<span class="mxinfo " id="T4:U157">1</span></span></span>
<span class="srcline"><span class="lineno"><a href="230,29" id="srcline29"> 29</a></span><span class="line">    <span class="mxinfo " id="T802:U158"><span class="var type1" id="S21T802U291">laplacian</span> = <span class="mxinfo " id="T802:U160"><span class="mxinfo " id="T802:U161">bsxfun(@times, <span class="mxinfo " id="T802:U162"><span class="var type1" id="S11T929U298">laplacian1</span>(:,:,:,<span class="var type1" id="S16T4U302">i</span>)</span>, <span class="mxinfo " id="T804:U165"><span class="var type1" id="S14T899U304">gaussMask</span>(:,:,<span class="var type1" id="S16T4U307">i</span>)</span>)</span> + <span class="mxinfo " id="T802:U168">bsxfun(@times, <span class="mxinfo " id="T802:U169"><span class="var type1" id="S12T929U313">laplacian2</span>(:,:,:,<span class="var type1" id="S16T4U317">i</span>)</span>, <span class="mxinfo " id="T804:U172">~<span class="mxinfo " id="T804:U173"><span class="var type1" id="S14T899U320">gaussMask</span>(:,:,<span class="var type1" id="S16T4U323">i</span>)</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="230,30" id="srcline30"> 30</a></span><span class="line">    <span class="mxinfo " id="T802:U176"><span class="var type1" id="S2T802U326">imageRecon</span> = <span class="mxinfo " id="T802:U178"><span class="fcn" id="F2188N25:B328">pyrBlendUp</span>(<span class="var type1" id="S2T802U329">imageRecon</span>, <span class="mxinfo " id="T173:U180"><span class="var type1" id="S13T806U331">imsize</span>(<span class="mxinfo " id="T4:U182"><span class="var type1" id="S16T4U333">i</span>+<span class="mxinfo " id="T4:U184">1</span></span>,:)</span>,<span class="mxinfo " id="T173:U185"><span class="var type1" id="S13T806U337">imsize</span>(<span class="var type1" id="S16T4U338">i</span>,:)</span>, <span class="var type1" id="S21T802U340">laplacian</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="230,31" id="srcline31"> 31</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="230,32" id="srcline32"> 32</a></span><span class="line"><span class="mxinfo " id="T127:U189"><span class="var type1" id="S2T127U343">imageRecon</span> = <span class="mxinfo " id="T127:U191">uint8(<span class="var type1" id="S2T802U346">imageRecon</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="230,33" id="srcline33"> 33</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="230,34" id="srcline34"> 34</a></span><span class="line"></span></span>
</pre>
